---
version: '3'
services:

  ros-master:
    image: "frankjoshua/ros-master:${ARCH:-latest}"
    build: ./docker_ros_nodes/ros-master
    volumes:
      - $HOME/ros:/root/.ros
    env_file:
      - ros.env
    network_mode: "host"

  ros-irobot-create-2:
    image: "frankjoshua/ros-irobot-create-2:${ARCH:-latest}"
    build: ./docker_ros_nodes/ros-irobot-create-2
    devices:
      - /dev/ttyUSB0:/dev/ttyUSB0
    env_file:
      - ros.env
    network_mode: "host"

  ros-vel-muxer:
    image: "frankjoshua/ros-vel-muxer:${ARCH:-latest}"
    build: ./docker_ros_nodes/ros-vel-muxer
    volumes:
      - $HOME/gobbit/docker_ros_nodes/ros-vel-muxer/node.py:/node.py
    env_file:
      - ros.env
    network_mode: "host"
    command: python /node.py --computer_topic /cmd_vel/computer --manual_topic /pocketbot/cmd_vel --output_topic /cmd_vel --delay 5
